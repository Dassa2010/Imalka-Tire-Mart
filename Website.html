<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Professional Inventory System</title>
<style>
body { font-family: Arial,sans-serif; background:#f4f6f8; margin:0; padding:0;}
.container { max-width: 1000px; margin:30px auto; padding:20px; background:#fff; border-radius:8px; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
h1,h2,h3 { color:#1d4ed8; margin:0 0 15px;}
input, button, select { padding:8px 12px; margin:4px 0; border-radius:4px; border:1px solid #ccc; font-size:14px;}
button { background:#1d4ed8; color:#fff; border:none; cursor:pointer;}
button:hover { background:#2563eb;}
table { width:100%; border-collapse:collapse; margin-top:15px;}
th, td { padding:10px; text-align:left; border-bottom:1px solid #ddd;}
th { background:#f0f4ff; color:#1d4ed8;}
.low-stock { background:#fff7f0; color:#b45309; font-weight:bold;}
.top-bar { display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;}
.logout-btn { background:#ef4444;}
.logout-btn:hover { background:#dc2626;}
.form-inline input, .form-inline select { margin-right:5px; }
.hidden { display:none; }
</style>
</head>
<body>

<div class="container" id="login-container">
<h1>Login</h1>
<input type="password" id="login-password" placeholder="Enter password">
<button onclick="login()">Login</button>
<p id="login-error" style="color:red;"></p>
</div>

<div class="container hidden" id="app-container">
<div class="top-bar">
<h2>Professional Inventory System</h2>
<div>
<span id="total-value">Total Stock Value: $0</span>
<button class="logout-btn" onclick="logout()">Logout</button>
</div>
</div>

<!-- Add Item Form -->
<div>
<h3>Add / Edit Stock Item</h3>
<div class="form-inline">
<input type="hidden" id="edit-id">
<input type="text" id="item-name" placeholder="Item Name">
<input type="text" id="item-brand" placeholder="Brand">
<input type="number" id="item-quantity" placeholder="Quantity" min="0">
<input type="number" id="item-price" placeholder="Price per Item" min="0">
<button onclick="addOrUpdateItem()">Add / Update Item</button>
</div>
</div>

<!-- Stock Table -->
<div>
<h3>Current Stock</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Brand</th>
<th>Quantity</th>
<th>Price</th>
<th>Actions</th>
</tr>
</thead>
<tbody id="stock-table-body"></tbody>
</table>
</div>

<!-- Stock History -->
<div>
<h3>Stock Reduction History</h3>
<table>
<thead>
<tr>
<th>Item Name</th>
<th>Dealer</th>
<th>Quantity Reduced</th>
<th>Date / Time</th>
</tr>
</thead>
<tbody id="history-table-body"></tbody>
</table>
</div>

</div>

<script>
// --- Login ---
function login() {
    const password = document.getElementById('login-password').value;
    const errorEl = document.getElementById('login-error');
    if(password === "ImalkaTM") {
        localStorage.setItem('loggedIn','true');
        showApp();
    } else {
        errorEl.textContent = "Incorrect password";
    }
}

function logout() {
    localStorage.removeItem('loggedIn');
    document.getElementById('app-container').classList.add('hidden');
    document.getElementById('login-container').classList.remove('hidden');
}

function showApp() {
    document.getElementById('login-container').classList.add('hidden');
    document.getElementById('app-container').classList.remove('hidden');
    renderTable();
    renderHistory();
}

if(localStorage.getItem('loggedIn')==='true') showApp();

// --- Inventory ---
let stockItems = JSON.parse(localStorage.getItem('stockItems') || '[]');
let historyItems = JSON.parse(localStorage.getItem('historyItems') || '[]');

function saveStock() { localStorage.setItem('stockItems', JSON.stringify(stockItems)); }
function saveHistory() { localStorage.setItem('historyItems', JSON.stringify(historyItems)); }

function addOrUpdateItem() {
    const name = document.getElementById('item-name').value.trim();
    const brand = document.getElementById('item-brand').value.trim();
    const quantity = parseInt(document.getElementById('item-quantity').value);
    const price = parseFloat(document.getElementById('item-price').value);
    const editId = document.getElementById('edit-id').value;

    if(!name || !brand || isNaN(quantity) || quantity<0 || isNaN(price) || price<0){
        alert("Please fill all fields correctly"); return;
    }

    if(editId){
        const item = stockItems.find(i=>i.id==editId);
        item.name = name; item.brand = brand; item.quantity = quantity; item.price = price;
        document.getElementById('edit-id').value = '';
    } else {
        stockItems.push({id:Date.now(), name, brand, quantity, price});
    }
    saveStock();
    renderTable();
    document.getElementById('item-name').value=''; document.getElementById('item-brand').value='';
    document.getElementById('item-quantity').value=''; document.getElementById('item-price').value='';
}

function reduceStock(id) {
    const dealer = prompt("Enter dealer name to reduce stock:");
    if(!dealer) return;

    const qty = parseInt(prompt("Enter quantity to reduce:"));
    if(isNaN(qty) || qty<=0) return alert("Invalid quantity");

    const item = stockItems.find(i=>i.id==id);
    if(qty>item.quantity) return alert("Not enough stock");

    item.quantity -= qty;
    saveStock();

    historyItems.push({itemName:item.name,dealer,quantityReduced:qty,dateTime:new Date().toLocaleString()});
    saveHistory();
    renderTable(); renderHistory();
}

function editItem(id){
    const item = stockItems.find(i=>i.id==id);
    document.getElementById('item-name').value = item.name;
    document.getElementById('item-brand').value = item.brand;
    document.getElementById('item-quantity').value = item.quantity;
    document.getElementById('item-price').value = item.price;
    document.getElementById('edit-id').value = item.id;
}

function deleteItem(id){
    if(confirm("Are you sure you want to delete this item?")){
        stockItems = stockItems.filter(i=>i.id!=id);
        saveStock(); renderTable();
    }
}

function renderTable(){
    const tbody = document.getElementById('stock-table-body');
    tbody.innerHTML='';
    let totalValue=0;
    stockItems.forEach(item=>{
        const tr=document.createElement('tr');
        if(item.quantity<=5) tr.classList.add('low-stock');
        tr.innerHTML=`
        <td>${item.name}</td>
        <td>${item.brand}</td>
        <td>${item.quantity}</td>
        <td>$${item.price}</td>
        <td>
        <button onclick="reduceStock(${item.id})">Reduce</button>
        <button onclick="editItem(${item.id})" style="background:#facc15;">Edit</button>
        <button onclick="deleteItem(${item.id})" style="background:#ef4444;">Delete</button>
        </td>
        `;
        tbody.appendChild(tr);
        totalValue += item.quantity*item.price;
    });
    document.getElementById('total-value').textContent = "Total Stock Value: $"+totalValue;
}

function renderHistory(){
    const tbody = document.getElementById('history-table-body');
    tbody.innerHTML='';
    historyItems.forEach(h=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td>${h.itemName}</td><td>${h.dealer}</td><td>${h.quantityReduced}</td><td>${h.dateTime}</td>`;
        tbody.appendChild(tr);
    });
}
</script>
</body>
</html>



